import { NS } from "@ns";

/**
 * Weakens the specified target server with optional flags for threads and iterations.
 * @usage ns.exec("weaken.js", host, 1, <target>, --threads, <threads>, --iterations, <iterations>)
 * @example ns.exec("weaken.js", "n00dles", 1, "foodnstuff", "--threads", 2, "--iterations", 10)
 * @param ns - The netscript interface to bitburner functions.
 */
export async function main(ns: NS): Promise<void> {
    /* 
     * First argument is always the target server to weaken
     * Optional flags for threads and iterations
     *
    const flags = ns.flags([
        ['threads', 1],
        ['iterations', 1],
    ]);
    */
    const target = ns.args[0] as string;

    const startPerformance = performance.now();

    //ns.printf(`weakening ${target} with ${flags.threads} threads for ${flags.iterations} iterations.`);
    //const securityDecrease = await ns.weaken(target, { threads: flags.threads as number});
    const securityDecrease = await ns.weaken(target);
    ns.printf(`Security decreased by ${securityDecrease} on ${target} in ${(performance.now() - startPerformance).toFixed(2)} milliseconds.`);

}
