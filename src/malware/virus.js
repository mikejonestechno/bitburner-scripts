// import { functionName, functionName2 } from "./utils.js"
// RAM 2.25 GB (base, nuke, scp)

/* virus:  Nuke and copy files to targets.
 * syntax: virus.js host1,host2 file1.js,file2.js
 *
 * A virus is a type of malware that spreads through human intervention.
 * In this case the human is me, I have to explicitly specify the targets!
 * This could be called 'epsilon virus' because "in mathematics and 
 * computer science, an epsilon is a small positive number that is 
 * used to represent the limits of precision and accuracy in calculations."
 * This 'epsilon virus' uses the smallest possible RAM to spread, at the limit.
 */

/** @param {NS} ns **/
export async function main(ns) {

    const targets = ns.args[0].split(',');
    const files = ns.args[1].split(',');
    const args = ns.args.slice(2);
    const exec = true;    
  
    targets.forEach(hostname => {
        var start = performance.now();

        ns.nuke(hostname);

        // scp = secure copy protocol
        ns.scp(files, hostname);

        if (exec) {
            ns.exec(files[0], hostname, 1, ...args);
        }
        ns.printf(`Infected %s: %.2f milliseconds`, hostname, performance.now() - start);
    });

}