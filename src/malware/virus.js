// import { functionName, functionName2 } from "./utils.js"
// RAM 2.25 GB (base, nuke, scp)

/* virus:  Nuke and copy files to targets.
 * syntax: virus.js --targets=[hostnames] --files=[filenames] 
 *
 * A virus is a type of malware that spreads through human intervention.
 * In this case the human is me, I have to explicitly specify the targets!
 * This could be called 'epsilon virus' because "in mathematics and 
 * computer science, an epsilon is a small positive number that is 
 * used to represent the limits of precision and accuracy in calculations."
 * This 'epsilon virus' uses the smallest possible RAM to spread, at the limit.
 * 
 */

/** @param {NS} ns **/
export async function main(ns) {

    // Use JSON.stringify to pass array as an argument e.g.
    // ns.run("/malware/virus.js", 1, `--targets=${JSON.stringify(targets)}`);
    const args = ns.flags([
        ['targets', []], 
        ['files', []], 
    ]);
    const targets = JSON.parse(args.targets);
    const files = JSON.parse(args.files);    
  
    targets.forEach(hostname => {
        var start = performance.now();

        ns.nuke(hostname);

        // scp = secure copy protocol
        ns.scp(files, hostname);

        ns.printf(`Infected %s: %.2f milliseconds`, hostname, performance.now() - start);
    });

}